INFO:root:Namespace(json_root='./data', feature_root='data/features', stream_file='data/MAVEN/streams.json', batch_size=128, init_slots=13, patience=5, input_dim=2048, hidden_dim=512, max_slots=169, perm_id=0, no_gpu=False, gpu=0, learning_rate=0.0001, decay=0.01, kt_alpha=0.25, kt_gamma=0.05, kt_tau=1.0, kt_delta=0.5, seed=2147483647, save_model='model', load_model='results/checkpoint', log_dir='results/maven/FairGrad_woLMH_narate-4_cluster-4_gen-20/perm_0', train_epoch=15, test_only=False, kt=True, kt2=True, finetune=False, load_first='', skip_first=False, load_second='', skip_second=False, balance='none', setting='classic', mode='herding', kt_mode='herding', clusters=4, generate=True, sample_size=2, features_distill=False, hyer_distill=False, reduce_na=False, new_test_mode=False, num_loss=4, mul_task=True, contrastive=False, mul_distill=True, mul_task_type='FairGrad', naive_replay=False, debug=False, colab_viet=False, datasetname='MAVEN', center_ratio=1, generate_ratio=20, naloss_ratio=4, dropout='normal', p=0.2, num_sam_loss=2, sam=0, ot=False, mi=False, lmh=False, loss_trick=True, llm2vec=False, no_lm_head=False, no_class_loss=False, fairgrad_alpha=2.0, class_alpha=0.2, lm_temp=2.0, log='results/maven/FairGrad_woLMH_narate-4_cluster-4_gen-20/perm_0/logfile.log')
INFO:root:{0: 0, 134: 1, 99: 2, 105: 3, 91: 4, 52: 5, 19: 6, 135: 7, 122: 8, 127: 9, 102: 10, 108: 11, 104: 12, 110: 13, 38: 14, 118: 15, 121: 16, 160: 17, 26: 18, 34: 19, 33: 20, 158: 21, 130: 22, 165: 23, 86: 24, 149: 25, 146: 26, 164: 27, 4: 28, 131: 29, 75: 30, 90: 31, 10: 32, 32: 33, 46: 34, 36: 35, 17: 36, 13: 37, 12: 38, 20: 39, 25: 40, 49: 41, 169: 42, 148: 43, 87: 44, 56: 45, 95: 46, 81: 47, 58: 48, 57: 49, 161: 50, 64: 51, 163: 52, 82: 53, 43: 54, 125: 55, 35: 56, 96: 57, 156: 58, 100: 59, 66: 60, 30: 61, 50: 62, 120: 63, 147: 64, 48: 65, 84: 66, 39: 67, 53: 68, 23: 69, 109: 70, 22: 71, 77: 72, 62: 73, 93: 74, 143: 75, 89: 76, 8: 77, 71: 78, 85: 79, 63: 80, 97: 81, 65: 82, 103: 83, 113: 84, 112: 85, 123: 86, 152: 87, 88: 88, 98: 89, 72: 90, 42: 91, 60: 92, 133: 93, 128: 94, 116: 95, 15: 96, 111: 97, 136: 98, 162: 99, 129: 100, 132: 101, 6: 102, 157: 103, 18: 104, 114: 105, 92: 106, 67: 107, 153: 108, 80: 109, 115: 110, 78: 111, 154: 112, 27: 113, 5: 114, 69: 115, 117: 116, 44: 117, 83: 118, 155: 119, 40: 120, 45: 121, 139: 122, 137: 123, 14: 124, 138: 125, 119: 126, 74: 127, 150: 128, 59: 129, 54: 130, 28: 131, 9: 132, 140: 133, 37: 134, 107: 135, 76: 136, 47: 137, 151: 138, 16: 139, 3: 140, 70: 141, 106: 142, 141: 143, 68: 144, 31: 145, 79: 146, 101: 147, 166: 148, 167: 149, 94: 150, 21: 151, 51: 152, 7: 153, 73: 154, 145: 155, 2: 156, 124: 157, 159: 158, 61: 159, 41: 160, 142: 161, 126: 162, 144: 163, 55: 164, 168: 165, 29: 166, 11: 167, 24: 168}
INFO:root:Epoch   1  Train Loss 0.3854 80.79%
INFO:root:Epoch   1:  Dev 0.6059131622314453
INFO:root:Epoch   1: Test 0.6303265690803528
INFO:root:Epoch   2  Train Loss 0.2054 81.87%
INFO:root:Epoch   2:  Dev 0.6193879246711731
INFO:root:Epoch   2: Test 0.6419131755828857
INFO:root:Epoch   3  Train Loss 0.1732 81.97%
INFO:root:Epoch   3:  Dev 0.6228232979774475
INFO:root:Epoch   3: Test 0.6463336944580078
INFO:root:Epoch   4  Train Loss 0.1517 82.04%
INFO:root:Epoch   4:  Dev 0.648101270198822
INFO:root:Epoch   4: Test 0.6669631600379944
INFO:root:Epoch   5  Train Loss 0.1325 82.18%
INFO:root:Epoch   5:  Dev 0.6476007699966431
INFO:root:Epoch   6  Train Loss 0.1181 82.27%
INFO:root:Epoch   6:  Dev 0.6273292303085327
INFO:root:Epoch   7  Train Loss 0.1048 82.39%
INFO:root:Epoch   7:  Dev 0.6390262246131897
INFO:root:Epoch   8  Train Loss 0.0945 82.49%
INFO:root:Epoch   8:  Dev 0.6402439475059509
INFO:root:Epoch   9  Train Loss 0.0859 82.58%
INFO:root:Epoch   9:  Dev 0.6432950496673584
INFO:root:BEST DEV 0: 0.648101270198822
INFO:root:BEST TEST 0: 0.6669631600379944
INFO:root:Epoch   1  Train Loss 8.4138 83.71%
INFO:root:Epoch   1:  Dev 0.35020947456359863
INFO:root:Epoch   1: Test 0.3604820668697357
INFO:root:Epoch   2  Train Loss 4.8789 85.35%
INFO:root:Epoch   2:  Dev 0.37784114480018616
INFO:root:Epoch   2: Test 0.38964298367500305
INFO:root:Epoch   3  Train Loss 5.9855 87.44%
INFO:root:Epoch   3:  Dev 0.426641047000885
INFO:root:Epoch   3: Test 0.43871790170669556
INFO:root:Epoch   4  Train Loss 7.5433 89.00%
INFO:root:Epoch   4:  Dev 0.45546507835388184
INFO:root:Epoch   4: Test 0.4668102562427521
INFO:root:Epoch   5  Train Loss 9.4566 90.19%
INFO:root:Epoch   5:  Dev 0.49416717886924744
INFO:root:Epoch   5: Test 0.5063506364822388
INFO:root:Epoch   6  Train Loss 11.5906 91.08%
INFO:root:Epoch   6:  Dev 0.5067971348762512
INFO:root:Epoch   6: Test 0.5190839767456055
INFO:root:Epoch   7  Train Loss 14.2725 91.74%
INFO:root:Epoch   7:  Dev 0.5246753096580505
INFO:root:Epoch   7: Test 0.5379230380058289
INFO:root:Epoch   8  Train Loss 17.1298 92.35%
INFO:root:Epoch   8:  Dev 0.551841676235199
INFO:root:Epoch   8: Test 0.5637937188148499
INFO:root:Epoch   9  Train Loss 19.9430 92.94%
INFO:root:Epoch   9:  Dev 0.5762041211128235
INFO:root:Epoch   9: Test 0.589357852935791
INFO:root:Epoch  10  Train Loss 22.2574 93.74%
INFO:root:Epoch  10:  Dev 0.5833907723426819
INFO:root:Epoch  10: Test 0.5984375476837158
INFO:root:Epoch  11  Train Loss 24.1547 93.98%
INFO:root:Epoch  11:  Dev 0.5896956324577332
INFO:root:Epoch  11: Test 0.6079116463661194
INFO:root:Epoch  12  Train Loss 26.8544 94.19%
INFO:root:Epoch  12:  Dev 0.5999595522880554
INFO:root:Epoch  12: Test 0.6170150637626648
INFO:root:Epoch  13  Train Loss 28.9733 94.37%
INFO:root:Epoch  13:  Dev 0.6035158634185791
INFO:root:Epoch  13: Test 0.6225667595863342
INFO:root:Epoch  14  Train Loss 32.0855 94.52%
INFO:root:Epoch  14:  Dev 0.6030626893043518
INFO:root:Epoch  15  Train Loss 35.3624 94.63%
INFO:root:Epoch  15:  Dev 0.6153368353843689
INFO:root:Epoch  15: Test 0.6352100372314453
INFO:root:BEST DEV 1: 0.6153368353843689
INFO:root:BEST TEST 1: 0.6352100372314453
INFO:root:Epoch   1  Train Loss 6.4248 83.89%
INFO:root:Epoch   1:  Dev 0.37602540850639343
INFO:root:Epoch   1: Test 0.3829014301300049
INFO:root:Epoch   2  Train Loss 4.3402 81.29%
INFO:root:Epoch   2:  Dev 0.42413702607154846
INFO:root:Epoch   2: Test 0.43414151668548584
INFO:root:Epoch   3  Train Loss 5.0722 83.86%
INFO:root:Epoch   3:  Dev 0.46526890993118286
INFO:root:Epoch   3: Test 0.47597354650497437
INFO:root:Epoch   4  Train Loss 6.1112 85.77%
INFO:root:Epoch   4:  Dev 0.4903504252433777
INFO:root:Epoch   4: Test 0.5055720210075378
INFO:root:Epoch   5  Train Loss 7.0664 87.03%
INFO:root:Epoch   5:  Dev 0.5087552070617676
INFO:root:Epoch   5: Test 0.5258885025978088
INFO:root:Epoch   6  Train Loss 8.3047 88.20%
INFO:root:Epoch   6:  Dev 0.5283298492431641
INFO:root:Epoch   6: Test 0.5455507040023804
INFO:root:Epoch   7  Train Loss 9.6332 89.15%
INFO:root:Epoch   7:  Dev 0.5296044945716858
INFO:root:Epoch   7: Test 0.5493299961090088
INFO:root:Epoch   8  Train Loss 10.9506 89.75%
INFO:root:Epoch   8:  Dev 0.5534607172012329
INFO:root:Epoch   8: Test 0.5731338858604431
INFO:root:Epoch   9  Train Loss 12.3834 90.37%
INFO:root:Epoch   9:  Dev 0.5660473704338074
INFO:root:Epoch   9: Test 0.5844417810440063
INFO:root:Epoch  10  Train Loss 13.6870 90.88%
INFO:root:Epoch  10:  Dev 0.578829824924469
INFO:root:Epoch  10: Test 0.5931539535522461
INFO:root:Epoch  11  Train Loss 14.8493 91.33%
INFO:root:Epoch  11:  Dev 0.5803704261779785
INFO:root:Epoch  11: Test 0.5971413254737854
INFO:root:Epoch  12  Train Loss 16.0474 91.79%
INFO:root:Epoch  12:  Dev 0.5902134776115417
INFO:root:Epoch  12: Test 0.6054103374481201
INFO:root:Epoch  13  Train Loss 17.0665 92.17%
INFO:root:Epoch  13:  Dev 0.5989090800285339
INFO:root:Epoch  13: Test 0.6142433285713196
INFO:root:Epoch  14  Train Loss 18.4214 92.49%
INFO:root:Epoch  14:  Dev 0.60642409324646
INFO:root:Epoch  14: Test 0.6195970773696899
INFO:root:Epoch  15  Train Loss 19.5898 92.69%
INFO:root:Epoch  15:  Dev 0.6136116981506348
INFO:root:Epoch  15: Test 0.6226604580879211
INFO:root:BEST DEV 2: 0.6136116981506348
INFO:root:BEST TEST 2: 0.6226604580879211
INFO:root:Epoch   1  Train Loss 9.3741 81.74%
INFO:root:Epoch   1:  Dev 0.390658974647522
INFO:root:Epoch   1: Test 0.4048658013343811
INFO:root:Epoch   2  Train Loss 8.1074 77.40%
INFO:root:Epoch   2:  Dev 0.410592257976532
INFO:root:Epoch   2: Test 0.42316967248916626
INFO:root:Epoch   3  Train Loss 9.3570 80.25%
INFO:root:Epoch   3:  Dev 0.4557788074016571
INFO:root:Epoch   3: Test 0.467475950717926
INFO:root:Epoch   4  Train Loss 11.0210 82.21%
INFO:root:Epoch   4:  Dev 0.4712813198566437
INFO:root:Epoch   4: Test 0.48603108525276184
INFO:root:Epoch   5  Train Loss 12.3839 83.48%
INFO:root:Epoch   5:  Dev 0.48525702953338623
INFO:root:Epoch   5: Test 0.4986206591129303
INFO:root:Epoch   6  Train Loss 13.6129 84.78%
INFO:root:Epoch   6:  Dev 0.5043640732765198
INFO:root:Epoch   6: Test 0.5183858275413513
INFO:root:Epoch   7  Train Loss 14.7563 86.52%
INFO:root:Epoch   7:  Dev 0.5227490067481995
INFO:root:Epoch   7: Test 0.5373404622077942
INFO:root:Epoch   8  Train Loss 16.5322 87.76%
INFO:root:Epoch   8:  Dev 0.5401459336280823
INFO:root:Epoch   8: Test 0.5556091666221619
INFO:root:Epoch   9  Train Loss 18.3706 88.47%
INFO:root:Epoch   9:  Dev 0.5426326394081116
INFO:root:Epoch   9: Test 0.5559114217758179
INFO:root:Epoch  10  Train Loss 20.4736 88.98%
INFO:root:Epoch  10:  Dev 0.5598142147064209
INFO:root:Epoch  10: Test 0.5738158226013184
INFO:root:Epoch  11  Train Loss 22.4589 89.50%
INFO:root:Epoch  11:  Dev 0.5647894144058228
INFO:root:Epoch  11: Test 0.5784540176391602
INFO:root:Epoch  12  Train Loss 24.1079 89.73%
INFO:root:Epoch  12:  Dev 0.566616415977478
INFO:root:Epoch  12: Test 0.5805628299713135
INFO:root:Epoch  13  Train Loss 25.8095 90.03%
INFO:root:Epoch  13:  Dev 0.5675182342529297
INFO:root:Epoch  13: Test 0.582090437412262
INFO:root:Epoch  14  Train Loss 27.7351 90.34%
INFO:root:Epoch  14:  Dev 0.5739684700965881
INFO:root:Epoch  14: Test 0.5871011018753052
INFO:root:Epoch  15  Train Loss 29.0799 90.49%
INFO:root:Epoch  15:  Dev 0.5788062810897827
INFO:root:Epoch  15: Test 0.5902020931243896
INFO:root:BEST DEV 3: 0.5788062810897827
INFO:root:BEST TEST 3: 0.5902020931243896
INFO:root:Epoch   1  Train Loss 12.2699 86.03%
INFO:root:Epoch   1:  Dev 0.5212076306343079
INFO:root:Epoch   1: Test 0.5362404584884644
INFO:root:Epoch   2  Train Loss 36.0785 85.76%
INFO:root:Epoch   2:  Dev 0.483428418636322
INFO:root:Epoch   3  Train Loss 52.4882 82.75%
INFO:root:Epoch   3:  Dev 0.48848313093185425
INFO:root:Epoch   4  Train Loss 48.8842 84.06%
INFO:root:Epoch   4:  Dev 0.5069291591644287
INFO:root:Epoch   5  Train Loss 50.8961 85.28%
INFO:root:Epoch   5:  Dev 0.5158777832984924
INFO:root:Epoch   6  Train Loss 53.8435 86.20%
INFO:root:Epoch   6:  Dev 0.5294261574745178
INFO:root:Epoch   6: Test 0.5408617258071899
INFO:root:Epoch   7  Train Loss 58.5840 86.76%
INFO:root:Epoch   7:  Dev 0.5337818264961243
INFO:root:Epoch   7: Test 0.5449286699295044
INFO:root:Epoch   8  Train Loss 62.4786 87.32%
INFO:root:Epoch   8:  Dev 0.5404143929481506
INFO:root:Epoch   8: Test 0.5521553754806519
INFO:root:Epoch   9  Train Loss 66.3204 87.74%
INFO:root:Epoch   9:  Dev 0.5437365770339966
INFO:root:Epoch   9: Test 0.5559982657432556
INFO:root:Epoch  10  Train Loss 68.2541 88.19%
INFO:root:Epoch  10:  Dev 0.5473126769065857
INFO:root:Epoch  10: Test 0.5615805983543396
INFO:root:Epoch  11  Train Loss 70.5720 88.53%
INFO:root:Epoch  11:  Dev 0.553501546382904
INFO:root:Epoch  11: Test 0.5642268657684326
INFO:root:Epoch  12  Train Loss 75.1195 88.85%
INFO:root:Epoch  12:  Dev 0.5547117590904236
INFO:root:Epoch  12: Test 0.5659465789794922
INFO:root:Epoch  13  Train Loss 74.9072 89.11%
INFO:root:Epoch  13:  Dev 0.5595059394836426
INFO:root:Epoch  13: Test 0.56975257396698
INFO:root:Epoch  14  Train Loss 78.9264 89.36%
INFO:root:Epoch  14:  Dev 0.5594001412391663
INFO:root:Epoch  15  Train Loss 81.7695 89.55%
INFO:root:Epoch  15:  Dev 0.566834032535553
INFO:root:Epoch  15: Test 0.5764251947402954
INFO:root:BEST DEV 4: 0.566834032535553
INFO:root:BEST TEST 4: 0.5764251947402954
