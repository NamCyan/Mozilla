INFO:root:Namespace(json_root='./data', feature_root='data/ace_features', stream_file='data/ACE/streams.json', batch_size=256, init_slots=13, patience=6, input_dim=2048, hidden_dim=512, max_slots=34, perm_id=3, no_gpu=False, gpu=0, learning_rate=0.0001, decay=0.01, kt_alpha=0.25, kt_gamma=0.05, kt_tau=1.0, kt_delta=0.5, seed=2147483647, save_model='model', load_model='checkpoints/ace/NashMTL_kl', log_dir='results/ace/NashMTL_woLMH_woSAM_narate-40_cluster-8_gen-10/perm_3', train_epoch=30, test_only=False, kt=True, kt2=True, finetune=False, load_first='', skip_first=False, load_second='', skip_second=False, balance='none', setting='classic', mode='herding', kt_mode='herding', clusters=8, generate=True, sample_size=2, features_distill=False, hyer_distill=False, reduce_na=False, new_test_mode=False, num_loss=4, mul_task=True, contrastive=False, mul_distill=True, mul_task_type='NashMTL', naive_replay=False, debug=False, colab_viet=False, datasetname='ACE', center_ratio=1, generate_ratio=10, naloss_ratio=40, dropout='normal', p=0.2, num_sam_loss=2, sam=0, ot=False, mi=False, lmh=False, loss_trick=True, llm2vec=False, no_lm_head=False, no_class_loss=False, fairgrad_alpha=0.8, class_alpha=0.2, lm_temp=2.0, robust_step_size=0.001, log='results/ace/NashMTL_woLMH_woSAM_narate-40_cluster-8_gen-10/perm_3/logfile.log')
INFO:root:{0: 0, 191: 1, 187: 2, 195: 3, 171: 4, 174: 5, 179: 6, 201: 7, 183: 8, 193: 9, 172: 10, 175: 11, 188: 12, 199: 13, 184: 14, 194: 15, 189: 16, 190: 17, 178: 18, 186: 19, 197: 20, 200: 21, 180: 22, 173: 23, 198: 24, 177: 25, 196: 26, 181: 27, 182: 28, 202: 29, 185: 30, 176: 31, 170: 32, 192: 33}
INFO:root:Epoch   1  Train Loss 0.0840 98.24%
INFO:root:Epoch   1:  Dev 0.5233644843101501
INFO:root:Epoch   1: Test 0.5046296119689941
INFO:root:Epoch   2  Train Loss 0.0232 98.53%
INFO:root:Epoch   2:  Dev 0.5436893105506897
INFO:root:Epoch   2: Test 0.5913043022155762
INFO:root:Epoch   3  Train Loss 0.0168 98.55%
INFO:root:Epoch   3:  Dev 0.5039369463920593
INFO:root:Epoch   4  Train Loss 0.0128 98.58%
INFO:root:Epoch   4:  Dev 0.5686274170875549
INFO:root:Epoch   4: Test 0.5954692959785461
INFO:root:Epoch   5  Train Loss 0.0097 98.61%
INFO:root:Epoch   5:  Dev 0.5081967115402222
INFO:root:Epoch   6  Train Loss 0.0078 98.64%
INFO:root:Epoch   6:  Dev 0.5161290168762207
INFO:root:Epoch   7  Train Loss 0.0066 98.66%
INFO:root:Epoch   7:  Dev 0.5794392824172974
INFO:root:Epoch   7: Test 0.6041055917739868
INFO:root:Epoch   8  Train Loss 0.0058 98.67%
INFO:root:Epoch   8:  Dev 0.5686274170875549
INFO:root:Epoch   9  Train Loss 0.0053 98.68%
INFO:root:Epoch   9:  Dev 0.5799999833106995
INFO:root:Epoch   9: Test 0.5889968276023865
INFO:root:Epoch  10  Train Loss 0.0047 98.69%
INFO:root:Epoch  10:  Dev 0.5904761552810669
INFO:root:Epoch  10: Test 0.5808219313621521
INFO:root:Epoch  11  Train Loss 0.0049 98.70%
INFO:root:Epoch  11:  Dev 0.5894736647605896
INFO:root:Epoch  12  Train Loss 0.0044 98.70%
INFO:root:Epoch  12:  Dev 0.6292135119438171
INFO:root:Epoch  12: Test 0.631205677986145
INFO:root:Epoch  13  Train Loss 0.0036 98.72%
INFO:root:Epoch  13:  Dev 0.6262626051902771
INFO:root:Epoch  14  Train Loss 0.0035 98.71%
INFO:root:Epoch  14:  Dev 0.5799999833106995
INFO:root:Epoch  15  Train Loss 0.0035 98.72%
INFO:root:Epoch  15:  Dev 0.6086956858634949
INFO:root:Epoch  16  Train Loss 0.0035 98.71%
INFO:root:Epoch  16:  Dev 0.6086956858634949
INFO:root:Epoch  17  Train Loss 0.0027 98.73%
INFO:root:Epoch  17:  Dev 0.6170212626457214
INFO:root:Epoch  18  Train Loss 0.0027 98.73%
INFO:root:Epoch  18:  Dev 0.6373626589775085
INFO:root:Epoch  18: Test 0.6228373646736145
INFO:root:Epoch  19  Train Loss 0.0030 98.72%
INFO:root:Epoch  19:  Dev 0.5591397881507874
INFO:root:Epoch  20  Train Loss 0.0027 98.73%
INFO:root:Epoch  20:  Dev 0.5370370149612427
INFO:root:Epoch  21  Train Loss 0.0024 98.73%
INFO:root:Epoch  21:  Dev 0.5806452035903931
INFO:root:Epoch  22  Train Loss 0.0022 98.74%
INFO:root:Epoch  22:  Dev 0.5882353186607361
INFO:root:Epoch  23  Train Loss 0.0019 98.74%
INFO:root:Epoch  23:  Dev 0.5376344323158264
INFO:root:Epoch  24  Train Loss 0.0022 98.74%
INFO:root:Epoch  24:  Dev 0.5934066772460938
INFO:root:BEST DEV 0: 0.6373626589775085
INFO:root:BEST TEST 0: 0.6228373646736145
INFO:root:Epoch   1  Train Loss 1.8994 99.48%
INFO:root:Epoch   1:  Dev 0.5999999642372131
INFO:root:Epoch   1: Test 0.6792828440666199
INFO:root:Epoch   2  Train Loss 1.8493 99.66%
INFO:root:Epoch   2:  Dev 0.6329787373542786
INFO:root:Epoch   2: Test 0.6778242588043213
INFO:root:Epoch   3  Train Loss 1.8459 99.72%
INFO:root:Epoch   3:  Dev 0.6354166865348816
INFO:root:Epoch   3: Test 0.6851851940155029
INFO:root:Epoch   4  Train Loss 1.8316 99.76%
INFO:root:Epoch   4:  Dev 0.6233766078948975
INFO:root:Epoch   5  Train Loss 1.8336 99.78%
INFO:root:Epoch   5:  Dev 0.6472148299217224
INFO:root:Epoch   5: Test 0.675789475440979
INFO:root:Epoch   6  Train Loss 1.8340 99.82%
INFO:root:Epoch   6:  Dev 0.6310433149337769
INFO:root:Epoch   7  Train Loss 1.8273 99.84%
INFO:root:Epoch   7:  Dev 0.6442577242851257
INFO:root:Epoch   8  Train Loss 1.8316 99.87%
INFO:root:Epoch   8:  Dev 0.6291559934616089
INFO:root:Epoch   9  Train Loss 1.8270 99.87%
INFO:root:Epoch   9:  Dev 0.6540540456771851
INFO:root:Epoch   9: Test 0.7017167806625366
INFO:root:Epoch  10  Train Loss 1.8310 99.89%
INFO:root:Epoch  10:  Dev 0.6370757222175598
INFO:root:Epoch  11  Train Loss 1.8323 99.90%
INFO:root:Epoch  11:  Dev 0.6612021923065186
INFO:root:Epoch  11: Test 0.692556619644165
INFO:root:Epoch  12  Train Loss 1.8325 99.90%
INFO:root:Epoch  12:  Dev 0.6804733276367188
INFO:root:Epoch  12: Test 0.7018349170684814
INFO:root:Epoch  13  Train Loss 1.8133 99.91%
INFO:root:Epoch  13:  Dev 0.6647564768791199
INFO:root:Epoch  14  Train Loss 1.8224 99.93%
INFO:root:Epoch  14:  Dev 0.6453334093093872
INFO:root:Epoch  15  Train Loss 1.8188 99.92%
INFO:root:Epoch  15:  Dev 0.6610168814659119
INFO:root:Epoch  16  Train Loss 1.8266 99.93%
INFO:root:Epoch  16:  Dev 0.6553672552108765
INFO:root:Epoch  17  Train Loss 1.8280 99.93%
INFO:root:Epoch  17:  Dev 0.6743515729904175
INFO:root:Epoch  18  Train Loss 1.8181 99.94%
INFO:root:Epoch  18:  Dev 0.6253229975700378
INFO:root:BEST DEV 1: 0.6804733276367188
INFO:root:BEST TEST 1: 0.7018349170684814
INFO:root:Epoch   1  Train Loss 2.5002 99.31%
INFO:root:Epoch   1:  Dev 0.5616642236709595
INFO:root:Epoch   1: Test 0.6843065619468689
INFO:root:Epoch   2  Train Loss 2.4285 99.75%
INFO:root:Epoch   2:  Dev 0.5993884205818176
INFO:root:Epoch   2: Test 0.6967985033988953
INFO:root:Epoch   3  Train Loss 2.4207 99.80%
INFO:root:Epoch   3:  Dev 0.595678985118866
INFO:root:Epoch   4  Train Loss 2.4181 99.83%
INFO:root:Epoch   4:  Dev 0.5970588326454163
INFO:root:Epoch   5  Train Loss 2.4096 99.85%
INFO:root:Epoch   5:  Dev 0.5531914830207825
INFO:root:Epoch   6  Train Loss 2.4089 99.87%
INFO:root:Epoch   6:  Dev 0.5685425400733948
INFO:root:Epoch   7  Train Loss 2.4030 99.88%
INFO:root:Epoch   7:  Dev 0.5947611331939697
INFO:root:Epoch   8  Train Loss 2.4035 99.89%
INFO:root:Epoch   8:  Dev 0.6089645028114319
INFO:root:Epoch   8: Test 0.6881517171859741
INFO:root:Epoch   9  Train Loss 2.4009 99.90%
INFO:root:Epoch   9:  Dev 0.6184210777282715
INFO:root:Epoch   9: Test 0.6947162747383118
INFO:root:Epoch  10  Train Loss 2.4018 99.91%
INFO:root:Epoch  10:  Dev 0.5487977266311646
INFO:root:Epoch  11  Train Loss 2.4018 99.91%
INFO:root:Epoch  11:  Dev 0.6059654355049133
INFO:root:Epoch  12  Train Loss 2.3984 99.92%
INFO:root:Epoch  12:  Dev 0.5898617506027222
INFO:root:Epoch  13  Train Loss 2.4024 99.92%
INFO:root:Epoch  13:  Dev 0.6264273524284363
INFO:root:Epoch  13: Test 0.673287034034729
INFO:root:Epoch  14  Train Loss 2.4038 99.93%
INFO:root:Epoch  14:  Dev 0.6028257608413696
INFO:root:Epoch  15  Train Loss 2.3964 99.93%
INFO:root:Epoch  15:  Dev 0.6138613820075989
INFO:root:Epoch  16  Train Loss 2.3958 99.94%
INFO:root:Epoch  16:  Dev 0.6201298832893372
INFO:root:Epoch  17  Train Loss 2.4080 99.93%
INFO:root:Epoch  17:  Dev 0.6223662495613098
INFO:root:Epoch  18  Train Loss 2.4040 99.93%
INFO:root:Epoch  18:  Dev 0.642361044883728
INFO:root:Epoch  18: Test 0.6886597871780396
INFO:root:Epoch  19  Train Loss 2.3963 99.94%
INFO:root:Epoch  19:  Dev 0.6405451893806458
INFO:root:Epoch  20  Train Loss 2.3993 99.94%
INFO:root:Epoch  20:  Dev 0.6208000183105469
INFO:root:Epoch  21  Train Loss 2.4027 99.94%
INFO:root:Epoch  21:  Dev 0.6352941393852234
INFO:root:Epoch  22  Train Loss 2.4003 99.94%
INFO:root:Epoch  22:  Dev 0.6068111658096313
INFO:root:Epoch  23  Train Loss 2.3982 99.95%
INFO:root:Epoch  23:  Dev 0.6404109001159668
INFO:root:Epoch  24  Train Loss 2.3997 99.95%
INFO:root:Epoch  24:  Dev 0.6387960314750671
INFO:root:BEST DEV 2: 0.642361044883728
INFO:root:BEST TEST 2: 0.6886597871780396
INFO:root:Epoch   1  Train Loss 2.2489 98.70%
INFO:root:Epoch   1:  Dev 0.5840092897415161
INFO:root:Epoch   1: Test 0.6186627745628357
INFO:root:Epoch   2  Train Loss 2.1237 99.65%
INFO:root:Epoch   2:  Dev 0.586448609828949
INFO:root:Epoch   2: Test 0.6228528618812561
INFO:root:Epoch   3  Train Loss 2.1193 99.74%
INFO:root:Epoch   3:  Dev 0.5437100529670715
INFO:root:Epoch   4  Train Loss 2.1133 99.78%
INFO:root:Epoch   4:  Dev 0.5760368704795837
INFO:root:Epoch   5  Train Loss 2.1111 99.83%
INFO:root:Epoch   5:  Dev 0.6002400517463684
INFO:root:Epoch   5: Test 0.6352396011352539
INFO:root:Epoch   6  Train Loss 2.1051 99.86%
INFO:root:Epoch   6:  Dev 0.6100000143051147
INFO:root:Epoch   6: Test 0.6401299834251404
INFO:root:Epoch   7  Train Loss 2.1095 99.88%
INFO:root:Epoch   7:  Dev 0.5628604292869568
INFO:root:Epoch   8  Train Loss 2.1082 99.90%
INFO:root:Epoch   8:  Dev 0.620779275894165
INFO:root:Epoch   8: Test 0.6444073915481567
INFO:root:Epoch   9  Train Loss 2.1037 99.92%
INFO:root:Epoch   9:  Dev 0.6088050603866577
INFO:root:Epoch  10  Train Loss 2.1031 99.93%
INFO:root:Epoch  10:  Dev 0.6017698645591736
INFO:root:Epoch  11  Train Loss 2.1088 99.93%
INFO:root:Epoch  11:  Dev 0.6238532066345215
INFO:root:Epoch  11: Test 0.6247934103012085
INFO:root:Epoch  12  Train Loss 2.1046 99.94%
INFO:root:Epoch  12:  Dev 0.5972738265991211
INFO:root:Epoch  13  Train Loss 2.1043 99.94%
INFO:root:Epoch  13:  Dev 0.6123521327972412
INFO:root:Epoch  14  Train Loss 2.1032 99.95%
INFO:root:Epoch  14:  Dev 0.6086956262588501
INFO:root:Epoch  15  Train Loss 2.1031 99.95%
INFO:root:Epoch  15:  Dev 0.5977301001548767
INFO:root:Epoch  16  Train Loss 2.1040 99.96%
INFO:root:Epoch  16:  Dev 0.6173800230026245
INFO:root:Epoch  17  Train Loss 2.1018 99.96%
INFO:root:Epoch  17:  Dev 0.62618088722229
INFO:root:Epoch  17: Test 0.6279271245002747
INFO:root:Epoch  18  Train Loss 2.1022 99.95%
INFO:root:Epoch  18:  Dev 0.6105527877807617
INFO:root:Epoch  19  Train Loss 2.0987 99.96%
INFO:root:Epoch  19:  Dev 0.6047678589820862
INFO:root:Epoch  20  Train Loss 2.1020 99.96%
INFO:root:Epoch  20:  Dev 0.6083650588989258
INFO:root:Epoch  21  Train Loss 2.0997 99.96%
INFO:root:Epoch  21:  Dev 0.623828649520874
INFO:root:Epoch  22  Train Loss 2.1021 99.96%
INFO:root:Epoch  22:  Dev 0.5924051403999329
INFO:root:Epoch  23  Train Loss 2.1011 99.96%
INFO:root:Epoch  23:  Dev 0.6020671725273132
INFO:root:BEST DEV 3: 0.62618088722229
INFO:root:BEST TEST 3: 0.6279271245002747
INFO:root:Epoch   1  Train Loss 2.9180 98.41%
INFO:root:Epoch   1:  Dev 0.5877465605735779
INFO:root:Epoch   1: Test 0.5765885710716248
INFO:root:Epoch   2  Train Loss 2.7041 99.78%
INFO:root:Epoch   2:  Dev 0.5982906222343445
INFO:root:Epoch   2: Test 0.5856655240058899
INFO:root:Epoch   3  Train Loss 2.6950 99.84%
INFO:root:Epoch   3:  Dev 0.5746653079986572
INFO:root:Epoch   4  Train Loss 2.6880 99.87%
INFO:root:Epoch   4:  Dev 0.6067415475845337
INFO:root:Epoch   4: Test 0.5912669897079468
INFO:root:Epoch   5  Train Loss 2.6856 99.89%
INFO:root:Epoch   5:  Dev 0.6040723919868469
INFO:root:Epoch   6  Train Loss 2.6842 99.91%
INFO:root:Epoch   6:  Dev 0.6167400479316711
INFO:root:Epoch   6: Test 0.58913654088974
INFO:root:Epoch   7  Train Loss 2.6837 99.92%
INFO:root:Epoch   7:  Dev 0.6052631735801697
INFO:root:Epoch   8  Train Loss 2.6807 99.93%
INFO:root:Epoch   8:  Dev 0.5950225591659546
INFO:root:Epoch   9  Train Loss 2.6817 99.95%
INFO:root:Epoch   9:  Dev 0.6120591759681702
INFO:root:Epoch  10  Train Loss 2.6788 99.95%
INFO:root:Epoch  10:  Dev 0.6080178022384644
INFO:root:Epoch  11  Train Loss 2.6788 99.94%
INFO:root:Epoch  11:  Dev 0.6171171069145203
INFO:root:Epoch  11: Test 0.5926986336708069
INFO:root:Epoch  12  Train Loss 2.6788 99.95%
INFO:root:Epoch  12:  Dev 0.6109252572059631
INFO:root:Epoch  13  Train Loss 2.6763 99.95%
INFO:root:Epoch  13:  Dev 0.6064209342002869
INFO:root:Epoch  14  Train Loss 2.6802 99.95%
INFO:root:Epoch  14:  Dev 0.605140209197998
INFO:root:Epoch  15  Train Loss 2.6782 99.96%
INFO:root:Epoch  15:  Dev 0.6087912917137146
INFO:root:Epoch  16  Train Loss 2.6775 99.96%
INFO:root:Epoch  16:  Dev 0.6095017194747925
INFO:root:Epoch  17  Train Loss 2.6755 99.96%
INFO:root:Epoch  17:  Dev 0.6171967387199402
INFO:root:Epoch  17: Test 0.5820568799972534
INFO:root:Epoch  18  Train Loss 2.6778 99.97%
INFO:root:Epoch  18:  Dev 0.5835239887237549
INFO:root:Epoch  19  Train Loss 2.6760 99.97%
INFO:root:Epoch  19:  Dev 0.6111111044883728
INFO:root:Epoch  20  Train Loss 2.6752 99.97%
INFO:root:Epoch  20:  Dev 0.6130536198616028
INFO:root:Epoch  21  Train Loss 2.6753 99.97%
INFO:root:Epoch  21:  Dev 0.6076833605766296
INFO:root:Epoch  22  Train Loss 2.6748 99.97%
INFO:root:Epoch  22:  Dev 0.6056337952613831
INFO:root:Epoch  23  Train Loss 2.6774 99.96%
INFO:root:Epoch  23:  Dev 0.6059907674789429
INFO:root:BEST DEV 4: 0.6171967387199402
INFO:root:BEST TEST 4: 0.5820568799972534
